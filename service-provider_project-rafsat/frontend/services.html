<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browse Services - Service Provider Platform</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; background: #f5f5f5; }
        
        header { background: #2c3e50; color: white; padding: 1rem 0; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        nav { max-width: 1200px; margin: 0 auto; padding: 0 20px; display: flex; justify-content: space-between; align-items: center; }
        nav h2 { font-size: 1.5rem; }
        .nav-links { display: flex; gap: 20px; align-items: center; }
        .nav-links a { color: white; text-decoration: none; padding: 8px 15px; border-radius: 4px; transition: background 0.3s; }
        .nav-links a:hover { background: rgba(255,255,255,0.1); }
        .user-menu { position: relative; }
        .user-menu button { background: #3498db; color: white; border: none; padding: 8px 15px; border-radius: 4px; cursor: pointer; }
        .dropdown { display: none; position: absolute; top: 100%; right: 0; background: white; box-shadow: 0 2px 10px rgba(0,0,0,0.1); border-radius: 4px; margin-top: 5px; min-width: 150px; }
        .dropdown a { display: block; color: #333; padding: 10px 15px; text-decoration: none; }
        .dropdown a:hover { background: #f5f5f5; }
        .user-menu:hover .dropdown { display: block; }
        
        .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
        
        .page-header { background: white; padding: 30px; border-radius: 8px; margin-bottom: 30px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .page-header h1 { color: #2c3e50; margin-bottom: 10px; }
        
        .filters { background: white; padding: 20px; border-radius: 8px; margin-bottom: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .filters form { display: flex; gap: 15px; flex-wrap: wrap; align-items: end; }
        .filter-group { flex: 1; min-width: 200px; }
        .filter-group label { display: block; margin-bottom: 5px; font-weight: bold; color: #555; }
        .filter-group input, .filter-group select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 4px; }
        .filter-group button { background: #3498db; color: white; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; }
        .filter-group button:hover { background: #2980b9; }
        .clear-btn { background: #95a5a6 !important; }
        .clear-btn:hover { background: #7f8c8d !important; }
        
        .results-count { color: #555; margin-bottom: 20px; }
        
        .business-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; }
        .business-card { background: white; border-radius: 8px; padding: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); transition: transform 0.3s, box-shadow 0.3s; }
        .business-card:hover { transform: translateY(-5px); box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        .business-name { font-size: 1.3rem; color: #2c3e50; margin-bottom: 10px; font-weight: bold; }
        .business-category { display: inline-block; background: #3498db; color: white; padding: 4px 12px; border-radius: 20px; font-size: 0.85rem; margin-bottom: 10px; }
        .business-description { color: #666; margin-bottom: 15px; line-height: 1.5; }
        .business-location { color: #555; font-size: 0.9rem; margin-bottom: 10px; }
        .business-location strong { color: #2c3e50; }
        .view-btn { display: inline-block; background: #27ae60; color: white; padding: 10px 20px; text-decoration: none; border-radius: 4px; transition: background 0.3s; }
        .view-btn:hover { background: #229954; }
        
        .no-results { text-align: center; padding: 40px; background: white; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        .no-results h3 { color: #555; margin-bottom: 10px; }
        
        footer { background: #2c3e50; color: white; text-align: center; padding: 20px 0; margin-top: 50px; }
    </style>
</head>
<body>
    <header>
        <nav>
            <h2>Service Provider Platform</h2>
            <div class="nav-links">
                <a href="/">Home</a>
                <a href="/services">Services</a>
                <a href="/about">About</a>
                {% if current_user.is_authenticated %}
                    <div class="user-menu">
                        <button>{{ current_user.name }} ‚ñº</button>
                        <div class="dropdown">
                            <a href="/profile">My Profile</a>
                            <a href="/my-bookings">My Bookings</a>
                            <a href="/auth/logout">Logout</a>
                        </div>
                    </div>
                {% else %}
                    <a href="/auth/login">Login</a>
                    <a href="/auth/register">Register</a>
                {% endif %}
            </div>
        </nav>
    </header>

    <div class="container">
        <div class="page-header">
            <h1>Browse All Services</h1>
            <p>Find the perfect service provider for your needs</p>
        </div>

        <div class="filters">
            <form method="get" action="/services">
                <div class="filter-group">
                    <label for="search">Search</label>
                    <input type="text" id="search" name="q" placeholder="Business name, description..." value="{{ search_query }}">
                </div>
                <div class="filter-group">
                    <label for="category">Category</label>
                    <select id="category" name="category">
                        <option value="">All Categories</option>
                        {% for cat in categories %}
                        <option value="{{ cat.name }}" {% if cat.name == selected_category %}selected{% endif %}>
                            {{ cat.display_name }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
                <div class="filter-group">
                    <label for="city">City</label>
                    <select id="city" name="city">
                        <option value="">All Cities</option>
                        {% for c in cities %}
                        <option value="{{ c }}" {% if c == selected_city %}selected{% endif %}>{{ c }}</option>
                        {% endfor %}
                    </select>
                </div>
                <div class="filter-group">
                    <label>&nbsp;</label>
                    <button type="submit">Search</button>
                </div>
                <div class="filter-group">
                    <label>&nbsp;</label>
                    <a href="/services"><button type="button" class="clear-btn">Clear</button></a>
                </div>
            </form>
        </div>

        <p class="results-count"><strong>{{ businesses|length }}</strong> business{% if businesses|length != 1 %}es{% endif %} found</p>

        {% if businesses %}
        <div class="business-grid">
            {% for business in businesses %}
            <div class="business-card">
                <h3 class="business-name">{{ business.name }}</h3>
                <span class="business-category">{{ business.category|replace('_', ' ')|title }}</span>
                <p class="business-description">{{ business.description[:150] }}{% if business.description|length > 150 %}...{% endif %}</p>
                <p class="business-location">
                    <strong>üìç</strong> {{ business.district }}, {{ business.city }}
                </p>
                <p class="business-location">
                    <strong>üìß</strong> {{ business.email }} | <strong>üìû</strong> {{ business.phone }}
                </p>
                <a href="/business/{{ business.business_id }}" class="view-btn">View Details & Book</a>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="no-results">
            <h3>No businesses found</h3>
            <p>Try adjusting your search filters or <a href="/services">browse all services</a></p>
        </div>
        {% endif %}
    </div>

    <footer>
        <p>&copy; 2025 Service Provider Platform. All rights reserved.</p>
    </footer>
</body>
</html>
